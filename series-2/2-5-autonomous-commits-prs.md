# 자율적 코드 커밋 및 PR 생성

## AI 에이전트가 Git과 상호작용하는 방법

## 📖 개요

이 가이드는 AI 에이전트가 Git 저장소와 상호작용하여 자동으로 코드를 커밋하고 풀 리퀘스트를 생성하는 방법을 다룹니다. 완전 자동화된 개발 워크플로우의 핵심 구성 요소입니다.

## 🎯 학습 목표

이 가이드를 완료하면 다음을 달성할 수 있습니다:

- Git 자동화 도구 사용법 학습
- 브랜치 전략 및 관리 방법 이해
- 커밋 메시지 자동 생성 시스템 구축
- PR 템플릿과 리뷰어 할당 자동화
- AI 에이전트와 Git 연동 구현

## 📋 사전 요구사항

- Git 기본 명령어 숙지
- GitHub PR 프로세스 이해
- Python 중급 수준
- GitHub API 사용 경험

## ⏱️ 예상 소요 시간

**3시간** (난이도: 중급)

## 🔧 필요한 도구

- Python 3.8+
- Git
- 텍스트 에디터 (VS Code 권장)
- 터미널/명령 프롬프트

## 📚 핵심 개념

### Git 자동화의 핵심 원칙

AI 에이전트가 Git을 사용할 때는 일관성, 추적 가능성, 그리고 안전성을 보장해야 합니다.

### 브랜치 전략 설계

여러 에이전트가 동시에 작업할 수 있도록 적절한 브랜치 전략을 수립합니다.

### 커밋 메시지 표준화

자동 생성되는 커밋 메시지가 명확하고 일관성 있도록 표준을 수립합니다.


## 🛠️ 실습 단계

### Git 자동화 도구 설정

GitPython 또는 PyGithub를 사용하여 Git 작업을 자동화하는 도구를 설정합니다.

### 브랜치 관리 시스템 구현

에이전트별로 독립적인 브랜치를 생성하고 관리하는 시스템을 구현합니다.

### 커밋 메시지 생성기 개발

변경사항을 분석하여 적절한 커밋 메시지를 자동 생성하는 시스템을 개발합니다.

### PR 자동 생성 및 관리

작업 완료 시 자동으로 PR을 생성하고 적절한 리뷰어를 할당하는 시스템을 구축합니다.


## 💻 코드 예제

### Git 자동화 클래스

```python
import git
from github import Github
from datetime import datetime
import os

class GitAutomation:
    def __init__(self, repo_path, github_token):
        self.repo = git.Repo(repo_path)
        self.github = Github(github_token)
        self.repo_name = os.path.basename(repo_path)
    
    def create_feature_branch(self, feature_name, agent_name):
        """새로운 기능 브랜치 생성"""
        branch_name = f"feature/{agent_name}-{feature_name}-{datetime.now().strftime('%Y%m%d-%H%M%S')}"
        
        # 메인 브랜치에서 새 브랜치 생성
        self.repo.git.checkout('main')
        self.repo.git.pull()
        new_branch = self.repo.create_head(branch_name)
        new_branch.checkout()
        
        return branch_name
    
    def commit_changes(self, files, commit_message, agent_name):
        """변경사항 커밋"""
        # 파일 추가
        for file_path in files:
            self.repo.index.add(file_path)
        
        # 커밋 메시지 생성
        full_message = f"[{agent_name}] {commit_message}\n\nAuto-generated by AI agent"
        
        # 커밋 실행
        commit = self.repo.index.commit(full_message)
        return commit
    
    def push_branch(self, branch_name):
        """브랜치를 원격 저장소에 푸시"""
        origin = self.repo.remote('origin')
        origin.push(branch_name)
    
    def create_pull_request(self, branch_name, title, description, reviewers=None):
        """풀 리퀘스트 생성"""
        repo = self.github.get_repo(f"{self.repo.remote('origin').url.split('/')[-2]}/{self.repo_name}")
        
        pr = repo.create_pull(
            title=title,
            body=description,
            head=branch_name,
            base='main'
        )
        
        # 리뷰어 할당
        if reviewers:
            pr.create_review_request(reviewers=reviewers)
        
        return pr
```

### 커밋 메시지 생성기

```python
class CommitMessageGenerator:
    def __init__(self, llm):
        self.llm = llm
    
    def generate_commit_message(self, changed_files, diff_content):
        """변경사항을 분석하여 커밋 메시지 생성"""
        prompt = f"""
        다음 파일 변경사항을 분석하여 적절한 커밋 메시지를 생성해주세요:
        
        변경된 파일: {', '.join(changed_files)}
        
        변경 내용:
        {diff_content}
        
        다음 형식으로 커밋 메시지를 작성해주세요:
        - 첫 줄: 50자 이내의 간단한 요약
        - 빈 줄
        - 상세 설명 (선택사항)
        
        예시:
        feat: Add user authentication system
        
        - Implement login/logout functionality
        - Add JWT token management
        - Create user session handling
        """
        
        response = self.llm(prompt)
        return response.strip()
    
    def categorize_changes(self, changed_files):
        """변경사항을 카테고리별로 분류"""
        categories = {
            'feat': [],
            'fix': [],
            'docs': [],
            'style': [],
            'refactor': [],
            'test': [],
            'chore': []
        }
        
        for file_path in changed_files:
            if file_path.startswith('src/'):
                categories['feat'].append(file_path)
            elif file_path.startswith('tests/'):
                categories['test'].append(file_path)
            elif file_path.endswith('.md'):
                categories['docs'].append(file_path)
            else:
                categories['chore'].append(file_path)
        
        return categories
```


## 🔍 고급 기능


## 🚨 문제 해결


## 📖 추가 리소스

- [GitPython 문서](https://gitpython.readthedocs.io/)
- [PyGithub 문서](https://pygithub.readthedocs.io/)
- [Conventional Commits](https://www.conventionalcommits.org/)

## 🚀 다음 단계

이 가이드를 완료한 후 다음 가이드들을 학습해보세요:

- [품질 관리 구축](2-6-quality-control-setup.md)
- [자율적 QA 팀 구성](2-7-autonomous-qa-team.md)

## 📝 요약

이 가이드에서는 자율적 코드 커밋 및 PR 생성에 대해 학습했습니다. 주요 내용은 다음과 같습니다:

- Git 자동화 도구 사용법 학습
- 브랜치 전략 및 관리 방법 이해
- 커밋 메시지 자동 생성 시스템 구축
- PR 템플릿과 리뷰어 할당 자동화
- AI 에이전트와 Git 연동 구현

다음 가이드에서는 더 고급 주제를 다룰 예정입니다.

---

**"자율적 코드 커밋 및 PR 생성"** - 에이전틱 SaaS 조직 구축을 위한 핵심 가이드